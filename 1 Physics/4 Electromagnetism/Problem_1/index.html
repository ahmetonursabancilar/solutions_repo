<!DOCTYPE html>

<html class="writer-html5" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="IE=edge" http-equiv="X-UA-Compatible"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<link href="../../../img/favicon.ico" rel="shortcut icon"/>
<title>📘 Simulating the Effects of the Lorentz Force - Physics and Mathematics</title>
<link href="../../../css/theme.css" rel="stylesheet"/>
<link href="../../../css/theme_extra.css" rel="stylesheet"/>
<link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" rel="stylesheet"/>
<script>
        // Current page data
        var mkdocs_page_name = "\ud83d\udcd8 Simulating the Effects of the Lorentz Force";
        var mkdocs_page_input_path = "1 Physics/4 Electromagnetism/Problem_1.md";
        var mkdocs_page_url = null;
      </script>
<!--[if lt IE 9]>
      <script src="../../../js/html5shiv.min.js"></script>
    <![endif]-->
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/yaml.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/rust.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/python.min.js"></script>
<script>hljs.highlightAll();</script>
</head>
<body class="wy-body-for-nav" role="document">
<div class="wy-grid-for-nav">
<nav class="wy-nav-side stickynav" data-toggle="wy-nav-shift">
<div class="wy-side-scroll">
<div class="wy-side-nav-search">
<a class="icon icon-home" href="../../.."> Physics and Mathematics
        </a><div role="search">
<form action="../../../search.html" class="wy-form" id="rtd-search-form" method="get">
<input aria-label="Search docs" name="q" placeholder="Search docs" title="Type search term here" type="text"/>
</form>
</div>
</div>
<div aria-label="Navigation menu" class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation">
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../..">Introduction</a>
</li>
</ul>
<p class="caption"><span class="caption-text">1 Physics</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal">1 Mechanics</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../1%20Mechanics/Problem_1/">Problem 1</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../1%20Mechanics/Problem_2/">Problem 2</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal">2 Gravity</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../2%20Gravity/Problem_1/">Problem 1</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../2%20Gravity/Problem_2/">Problem 2</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../2%20Gravity/Problem_3/">Problem 3</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal">3 Waves</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../3%20Waves/Problem_1/">🌊 Interference Patterns on a Water Surface</a>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal current">4 Electromagnetism</a>
<ul class="current">
<li class="toctree-l2 current"><a class="reference internal current" href="#">📘 Simulating the Effects of the Lorentz Force</a>
<ul class="current">
<li class="toctree-l3"><a class="reference internal" href="#motivation">🎓 Motivation</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#1-introduction">🔎 1. Introduction</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#2-why-is-it-important">⚙️ 2. Why Is It Important?</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#3-types-of-motion">🧭 3. Types of Motion</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#4-key-physical-concepts">📐 4. Key Physical Concepts</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#5-real-world-systems-using-the-lorentz-force">🚀 5. Real-World Systems Using the Lorentz Force</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#cyclotrons">✅ Cyclotrons</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#mass-spectrometers">✅ Mass Spectrometers</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#magnetic-confinement-tokamaks">✅ Magnetic Confinement (Tokamaks)</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#6-simulation-goals">📌 6. Simulation Goals</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#7-what-will-be-delivered">📈 7. What Will Be Delivered</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#circular-motion-in-a-uniform-magnetic-field">🌀 Circular Motion in a Uniform Magnetic Field</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#explanation-circular-motion-in-a-uniform-magnetic-field">🔍 Explanation: Circular Motion in a Uniform Magnetic Field</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#helical-motion-in-a-uniform-magnetic-field">🧵 Helical Motion in a Uniform Magnetic Field</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#explanation">Explanation:</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#drift-motion-in-crossed-electric-and-magnetic-fields">🔀 Drift Motion in Crossed Electric and Magnetic Fields</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#python-code-drift-motion-in-crossed-vece-and-vecb-fields">✅ Python Code: Drift Motion in Crossed \(\vec{E}\) and \(\vec{B}\) Fields</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#_1"></a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#key-features">🔍 Key Features:</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#complex-3d-trajectory-with-non-perpendicular-e-and-b-fields">🔁 Complex 3D Trajectory with Non-Perpendicular E and B Fields</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#what-does-this-show">✨ What Does This Show?</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#conclusion">✅ Conclusion</a>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal">5 Circuits</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../5%20Circuits/Problem_1/">🎓 Equivalent Resistance Using Graph Theory</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal">6 Statistics</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../6%20Statistics/Problem_1/">Problem 1</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../6%20Statistics/Problem_2/">Problem 2</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal">7 Measurements</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../7%20Measurements/Problem_1/">Problem 1</a>
</li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">2 Mathematics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../2%20Mathematics/1%20Linear_algebra/">Linear Algebra</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../2%20Mathematics/2%20Analytic_geometry/">Analytic geometry</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../2%20Mathematics/3%20Calculus/">Calculus</a>
</li>
</ul>
<p class="caption"><span class="caption-text">3 Discret Mathematics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal">1 Set Theory and ...</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../../3%20Discret_Mathematics/1%20Set%20Theory%20and%20.../_02%20Set_Theory/">Set Theory</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../3%20Discret_Mathematics/1%20Set%20Theory%20and%20.../_03%20Relations/">Relations</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../3%20Discret_Mathematics/1%20Set%20Theory%20and%20.../_04%20Functions/">Functions</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal">2 Number Theory and ...</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../../3%20Discret_Mathematics/2%20Number%20Theory%20and%20.../_05%20Combinatorics/">Combinatorics</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../3%20Discret_Mathematics/2%20Number%20Theory%20and%20.../_08%20Number_Theory/">Number Theory</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal">3 Recurrence and ...</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../../3%20Discret_Mathematics/3%20Recurrence%20and%20.../_06%20Sequences_and_Series/">Sequences and Series</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../3%20Discret_Mathematics/3%20Recurrence%20and%20.../_07%20Induction/">Induction</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../3%20Discret_Mathematics/3%20Recurrence%20and%20.../_09%20Recurrence/">Recurrence</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal">4 Graph Theory and ...</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../../3%20Discret_Mathematics/4%20Graph%20Theory%20and%20.../_10%20Graph_Theory/">Graph Theory</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal">5 Logic</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../../3%20Discret_Mathematics/5%20Logic/_01%20Logic/">Logic</a>
</li>
</ul>
</li>
</ul>
</div>
</div>
</nav>
<section class="wy-nav-content-wrap" data-toggle="wy-nav-shift">
<nav aria-label="Mobile navigation menu" class="wy-nav-top" role="navigation">
<i class="fa fa-bars" data-toggle="wy-nav-top"></i>
<a href="../../..">Physics and Mathematics</a>
</nav>
<div class="wy-nav-content">
<div class="rst-content"><div aria-label="breadcrumbs navigation" role="navigation">
<ul class="wy-breadcrumbs">
<li><a aria-label="Docs" class="icon icon-home" href="../../.."></a></li>
<li class="breadcrumb-item">1 Physics</li>
<li class="breadcrumb-item">4 Electromagnetism</li>
<li class="breadcrumb-item active">📘 Simulating the Effects of the Lorentz Force</li>
<li class="wy-breadcrumbs-aside">
</li>
</ul>
<hr/>
</div>
<div class="document" itemscope="itemscope" itemtype="http://schema.org/Article" role="main">
<div class="section" itemprop="articleBody">
<h1 id="simulating-the-effects-of-the-lorentz-force">📘 Simulating the Effects of the Lorentz Force</h1>
<h3 id="motivation">🎓 Motivation</h3>
<p>For university students studying physics or engineering, mastering the behavior of charged particles under electric and magnetic fields is essential. This topic forms the basis of key technologies like MRI machines, cyclotrons, and plasma confinement in fusion energy. Through computational simulations and visualizations of the Lorentz force, we can deepen our understanding of theoretical concepts while also building practical skills in numerical methods and scientific programming.</p>
<h2 id="1-introduction">🔎 1. Introduction</h2>
<p>The <strong>Lorentz force</strong> is fundamental to the motion of charged particles in electric and magnetic fields. It is defined as:</p>
<div class="arithmatex">\[
\vec{F} = q(\vec{E} + \vec{v} \times \vec{B})
\]</div>
<p>Where:</p>
<ul>
<li><span class="arithmatex">\(\vec{F}\)</span>: Force on the particle (N)  </li>
<li><span class="arithmatex">\(q\)</span>: Charge of the particle (C)  </li>
<li><span class="arithmatex">\(\vec{E}\)</span>: Electric field (V/m)  </li>
<li><span class="arithmatex">\(\vec{v}\)</span>: Velocity of the particle (m/s)  </li>
<li><span class="arithmatex">\(\vec{B}\)</span>: Magnetic field (T)</li>
</ul>
<hr/>
<h2 id="2-why-is-it-important">⚙️ 2. Why Is It Important?</h2>
<p>The Lorentz force plays a key role in systems such as:</p>
<ul>
<li>🔬 <strong>Particle accelerators</strong> </li>
<li>🧪 <strong>Mass spectrometers</strong> </li>
<li>🌌 <strong>Astrophysical plasmas</strong> </li>
<li>⚡ <strong>Plasma confinement in fusion devices</strong></li>
</ul>
<hr/>
<h2 id="3-types-of-motion">🧭 3. Types of Motion</h2>
<table>
<thead>
<tr>
<th>Field Configuration</th>
<th>Resulting Motion</th>
</tr>
</thead>
<tbody>
<tr>
<td>Only <span class="arithmatex">\(\vec{B}\)</span></td>
<td>Circular / helical path</td>
</tr>
<tr>
<td>Only <span class="arithmatex">\(\vec{E}\)</span></td>
<td>Linear acceleration</td>
</tr>
<tr>
<td><span class="arithmatex">\(\vec{E} \parallel \vec{B}\)</span></td>
<td>Spiral acceleration</td>
</tr>
<tr>
<td><span class="arithmatex">\(\vec{E} \perp \vec{B}\)</span></td>
<td>Drift motion (<span class="arithmatex">\(\vec{E} \times \vec{B}\)</span> drift)</td>
</tr>
</tbody>
</table>
<hr/>
<h2 id="4-key-physical-concepts">📐 4. Key Physical Concepts</h2>
<ul>
<li><strong>Larmor Radius</strong>:</li>
</ul>
<div class="arithmatex">\[
r_L = \frac{mv_\perp}{qB}
\]</div>
<ul>
<li><strong>Cyclotron Frequency</strong>:</li>
</ul>
<div class="arithmatex">\[
\omega_c = \frac{qB}{m}
\]</div>
<ul>
<li><strong>Drift Velocity (for crossed fields):</strong></li>
</ul>
<div class="arithmatex">\[
\vec{v}_d = \frac{\vec{E} \times \vec{B}}{B^2}
\]</div>
<hr/>
<h2 id="5-real-world-systems-using-the-lorentz-force">🚀 5. Real-World Systems Using the Lorentz Force</h2>
<h3 id="cyclotrons">✅ Cyclotrons</h3>
<p>Particles spiral outward in a magnetic field while gaining energy from electric fields.</p>
<h3 id="mass-spectrometers">✅ Mass Spectrometers</h3>
<p>Charged particles are separated based on curvature of their paths in known fields.</p>
<h3 id="magnetic-confinement-tokamaks">✅ Magnetic Confinement (Tokamaks)</h3>
<p>Charged particles follow helical trajectories to remain confined inside plasma reactors.</p>
<hr/>
<h2 id="6-simulation-goals">📌 6. Simulation Goals</h2>
<p>We aim to simulate and visualize:</p>
<ol>
<li>Uniform magnetic field → Circular motion  </li>
<li>Combined electric and magnetic fields → Helical motion  </li>
<li>Crossed <span class="arithmatex">\(\vec{E}\)</span> and <span class="arithmatex">\(\vec{B}\)</span> fields → Drift motion  </li>
<li>Effects of varying:</li>
<li><span class="arithmatex">\(|\vec{E}|\)</span>, <span class="arithmatex">\(|\vec{B}|\)</span></li>
<li>Initial velocity</li>
<li>Particle charge and mass</li>
</ol>
<hr/>
<h2 id="7-what-will-be-delivered">📈 7. What Will Be Delivered</h2>
<ul>
<li>✅ Clean Python code for simulations  </li>
<li>✅ Clear 2D and 3D trajectory plots  </li>
<li>✅ Physical interpretation of motion  </li>
<li>✅ Extension ideas: non-uniform fields, particle beams, collisions</li>
</ul>
<hr/>
<h2 id="circular-motion-in-a-uniform-magnetic-field">🌀 Circular Motion in a Uniform Magnetic Field</h2>
<pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt

# Lorentz force function
def lorentz_force(q, m, E, B, v):
    return (q / m) * (E + np.cross(v, B))

# Euler integration
def simulate_particle_motion(q, m, E, B, v0, r0, dt=1e-5, steps=5000):
    r = np.zeros((steps, 3))
    v = np.zeros((steps, 3))
    r[0], v[0] = r0, v0

    for i in range(1, steps):
        a = lorentz_force(q, m, E, B, v[i - 1])
        v[i] = v[i - 1] + a * dt
        r[i] = r[i - 1] + v[i] * dt

    return r

# Parameters (user-specified)
q = 1.0                 # charge in Coulombs
m = 0.001               # mass in kg (1 gram)
B = np.array([0, 0, 1]) # magnetic field in z-direction (T)
E = np.array([0, 0, 0]) # no electric field
v0 = np.array([1.0, 0, 0]) # initial velocity in x-direction (m/s)
r0 = np.array([0, 0, 0])   # initial position

# Run simulation
trajectory = simulate_particle_motion(q, m, E, B, v0, r0)

# Plot result
plt.figure(figsize=(6, 6))
plt.plot(trajectory[:, 0], trajectory[:, 1], color='blue')
plt.title("Circular Motion in a Uniform Magnetic Field")
plt.xlabel("x (m)")
plt.ylabel("y (m)")
plt.grid(True)
plt.axis('equal')
plt.show()

</code></pre>
<p><img alt="alt text" src="../image-8.png"/></p>
<hr/>
<h3 id="explanation-circular-motion-in-a-uniform-magnetic-field">🔍 Explanation: Circular Motion in a Uniform Magnetic Field</h3>
<p>This plot demonstrates the <strong>circular trajectory</strong> of a charged particle moving in a uniform magnetic field when no electric field is present.</p>
<ul>
<li>
<p>The magnetic field $\vec{B}$ is directed <strong>out of the screen</strong> (along the z-axis).</p>
</li>
<li>
<p>The particle starts with an initial velocity $\vec{v}_0$ in the x-direction.</p>
</li>
<li>
<p>Since the <strong>Lorentz force</strong> is always perpendicular to the velocity:</p>
</li>
</ul>
<p>$$
  \vec{F} = q \vec{v} \times \vec{B}
  $$</p>
<p>the particle undergoes <strong>uniform circular motion</strong> in the x-y plane.</p>
<ul>
<li>The radius of the circular path is determined by:</li>
</ul>
<p>$$
  r = \frac{m v}{q B}
  $$</p>
<p>This behavior is fundamental in cyclotrons, mass spectrometers, and other charged particle control systems.</p>
<hr/>
<h2 id="helical-motion-in-a-uniform-magnetic-field">🧵 Helical Motion in a Uniform Magnetic Field</h2>
<pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
from mpl_toolkits.mplot3d import Axes3D

# Parameters for the helical motion
charge = 1.0  # Charge of the particle (Coulombs)
mass = 1.0    # Mass of the particle (kg)
velocity = 1.0  # Initial velocity of the particle (m/s)
B_field = np.array([0, 0, 1])  # Magnetic field direction (along z-axis)
time_steps = 1000  # Number of time steps in the simulation
radius = 1.0      # Radius of the circular path
pitch = 0.05      # The rate at which the spiral rises

# Time array
t = np.linspace(0, 20, time_steps)

# Velocity components (circular motion + linear motion)
omega = velocity / radius  # Angular frequency (rad/s)
x = radius * np.cos(omega * t)  # x component (circular motion)
y = radius * np.sin(omega * t)  # y component (circular motion)
z = pitch * t  # z component (linear motion)

# Plotting the spiral
fig = plt.figure()
ax = fig.add_subplot(111, projection='3d')

ax.plot(x, y, z, label='Helical Motion', color='b')

# Labels and title
ax.set_xlabel('X')
ax.set_ylabel('Y')
ax.set_zlabel('Z')
ax.set_title('Helical Motion in a Uniform Magnetic Field')

# Show the plot
plt.show()
</code></pre>
<p><img alt="alt text" src="../image-1.png"/></p>
<p>Here's a Python code to simulate <strong>Helical Motion in a Uniform Magnetic Field</strong> with the specified values for charge <span class="arithmatex">\(q = 1 \, \text{C}\)</span> and mass <span class="arithmatex">\(m = 1 \, \text{g}\)</span>:</p>
<pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
from mpl_toolkits.mplot3d import Axes3D

# Lorentz force function
def lorentz_force(q, m, E, B, v):
    return (q / m) * (E + np.cross(v, B))

# Euler integration
def simulate_particle_motion(q, m, E, B, v0, r0, dt=1e-11, steps=2000):
    r = np.zeros((steps, 3))
    v = np.zeros((steps, 3))
    r[0], v[0] = r0, v0

    for i in range(1, steps):
        a = lorentz_force(q, m, E, B, v[i-1])
        v[i] = v[i-1] + a * dt
        r[i] = r[i-1] + v[i] * dt

    return r

# Parameters
q = 1  # charge (C)
m = 1e-3  # mass (kg) - 1g = 1e-3 kg
B = np.array([0, 0, 1])  # magnetic field (T), in the z-direction
E = np.array([0, 0, 0])  # no electric field
v0 = np.array([1e5, 0, 1e5])  # initial velocity with components in x and z directions
r0 = np.array([0, 0, 0])  # initial position at origin

# Run simulation
trajectory = simulate_particle_motion(q, m, E, B, v0, r0)

# Plot in 3D
fig = plt.figure(figsize=(8, 6))
ax = fig.add_subplot(111, projection='3d')
ax.plot(trajectory[:, 0], trajectory[:, 1], trajectory[:, 2], color='green')
ax.set_title("Helical Motion in a Magnetic Field")
ax.set_xlabel("x (m)")
ax.set_ylabel("y (m)")
ax.set_zlabel("z (m)")
plt.show()
</code></pre>
<h3 id="explanation">Explanation:</h3>
<ul>
<li>The particle's initial velocity <span class="arithmatex">\(\vec{v_0}\)</span> has components in both the <span class="arithmatex">\(x\)</span>- and <span class="arithmatex">\(z\)</span>-directions.</li>
<li>The magnetic field <span class="arithmatex">\(\vec{B}\)</span> is in the <span class="arithmatex">\(z\)</span>-direction, causing the particle to move in a <strong>helical path</strong> around the magnetic field lines.</li>
<li>The <strong>Lorentz force</strong> <span class="arithmatex">\(q(\vec{v} \times \vec{B})\)</span> acts perpendicular to the velocity of the particle, resulting in circular motion in the <span class="arithmatex">\(x\)</span>-<span class="arithmatex">\(y\)</span> plane, while the motion along the <span class="arithmatex">\(z\)</span>-axis is due to the initial velocity component in the <span class="arithmatex">\(z\)</span>-direction.</li>
<li>The <strong>radius of the circular motion</strong> and the <strong>pitch</strong> of the helix depend on the initial velocity components, charge, and magnetic field strength.</li>
</ul>
<p>This code will generate a 3D plot showing the helical path of a charged particle moving in the magnetic field.</p>
<h2 id="drift-motion-in-crossed-electric-and-magnetic-fields">🔀 Drift Motion in Crossed Electric and Magnetic Fields</h2>
<p>Here's the <strong>Python code</strong> and all <strong>explanations translated into English</strong>, showing the <strong>drift motion of a charged particle</strong> in <strong>crossed electric and magnetic fields</strong>. The visualization includes <strong>multiple lines and plots</strong> to clearly display both the <strong>circular (gyration) motion</strong> and the <strong>overall drift</strong>.</p>
<hr/>
<h3 id="python-code-drift-motion-in-crossed-vece-and-vecb-fields">✅ Python Code: Drift Motion in Crossed <span class="arithmatex">\(\vec{E}\)</span> and <span class="arithmatex">\(\vec{B}\)</span> Fields</h3>
<pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt

# Physical constants and initial parameters
q = 1.0       # Charge (C)
m = 1.0       # Mass (kg)
E = np.array([0, 5, 0])    # Electric field (V/m)
B = np.array([0, 0, 2])    # Magnetic field (T)

# Initial conditions
r0 = np.array([0.0, 0.0, 0.0])  # Initial position
v0 = np.array([1.0, 0.0, 0.0])  # Initial velocity

# Time settings
dt = 0.01
t_max = 30
steps = int(t_max / dt)

# Arrays to store position and velocity over time
r = np.zeros((steps, 3))
v = np.zeros((steps, 3))
t = np.linspace(0, t_max, steps)

r[0] = r0
v[0] = v0

# Solve motion using a simple time-stepping method (Euler method)
for i in range(steps - 1):
    # Lorentz force: F = q(E + v × B)
    a = (q / m) * (E + np.cross(v[i], B))
    v[i + 1] = v[i] + a * dt
    r[i + 1] = r[i] + v[i + 1] * dt

# Theoretical drift velocity: v_d = (E × B) / B^2
v_drift = np.cross(E, B) / np.linalg.norm(B)**2
print("Drift velocity (E x B / B^2):", v_drift)

# Plotting
fig, axs = plt.subplots(2, 2, figsize=(12, 10))

# x-y plane motion: shows spiral (gyration) + drift
axs[0, 0].plot(r[:, 0], r[:, 1], label='Particle Path', color='blue')
axs[0, 0].quiver(r[::200, 0], r[::200, 1], v[::200, 0], v[::200, 1], color='red', scale=20, width=0.003)
axs[0, 0].set_title('Motion in x-y Plane (Spiral + Drift)')
axs[0, 0].set_xlabel('x')
axs[0, 0].set_ylabel('y')
axs[0, 0].grid()
axs[0, 0].legend()

# x position over time
axs[0, 1].plot(t, r[:, 0], label='x(t)', color='green')
axs[0, 1].set_title('x Position Over Time')
axs[0, 1].set_xlabel('Time (s)')
axs[0, 1].set_ylabel('x (m)')
axs[0, 1].grid()
axs[0, 1].legend()

# y position over time
axs[1, 0].plot(t, r[:, 1], label='y(t)', color='purple')
axs[1, 0].set_title('y Position Over Time')
axs[1, 0].set_xlabel('Time (s)')
axs[1, 0].set_ylabel('y (m)')
axs[1, 0].grid()
axs[1, 0].legend()

# Optional: 3D trajectory
from mpl_toolkits.mplot3d import Axes3D
ax3d = fig.add_subplot(224, projection='3d')
ax3d.plot(r[:, 0], r[:, 1], r[:, 2], label='3D Trajectory')
ax3d.set_title('3D Motion')
ax3d.set_xlabel('x')
ax3d.set_ylabel('y')
ax3d.set_zlabel('z')
ax3d.legend()

plt.tight_layout()
plt.show()
</code></pre>
<h2 id="_1"><img alt="alt text" src="../image-2.png"/></h2>
<h3 id="key-features">🔍 Key Features:</h3>
<ul>
<li><strong>Spiral + Drift</strong> motion in the x-y plane is clearly shown.</li>
<li>Multiple <strong>subplots</strong> give you time-evolution views of x(t), y(t), and 3D trajectory.</li>
<li>The <strong>drift velocity</strong> <span class="arithmatex">\(\vec{v}_d = \frac{\vec{E} \times \vec{B}}{B^2}\)</span> is computed and printed.</li>
<li><strong>Vector arrows</strong> (<code>quiver</code>) indicate particle velocity at sampled times.</li>
<li>You can increase the drift effect by increasing the strength of the electric field.</li>
</ul>
<p>This plot shows the drift motion of a charged particle when an electric field <span class="arithmatex">\(\vec{E}\)</span> is crossed with a magnetic field <span class="arithmatex">\(\vec{B}\)</span>. The particle doesn’t spiral but instead moves in a straight line, drifting with a velocity given by:</p>
<div class="arithmatex">\[
\vec{v}_\text{drift} = \frac{\vec{E} \times \vec{B}}{B^2}
\]</div>
<p>This velocity is perpendicular to both fields. This phenomenon is crucial in devices like magnetic confinement in fusion reactors.</p>
<hr/>
<p>Here's a Python simulation of an <strong>interesting trajectory</strong>: a <em>complex 3D motion</em> of a charged particle where both <strong>electric and magnetic fields are present and not aligned</strong>. This setup leads to a <strong>non-trivial spiraling drift</strong> — a motion that combines rotation, drift, and acceleration.</p>
<hr/>
<h3 id="complex-3d-trajectory-with-non-perpendicular-e-and-b-fields">🔁 Complex 3D Trajectory with Non-Perpendicular E and B Fields</h3>
<pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
from mpl_toolkits.mplot3d import Axes3D

# Lorentz force function
def lorentz_force(q, m, E, B, v):
    return (q / m) * (E + np.cross(v, B))

# Euler integration for particle motion
def simulate_particle_motion(q, m, E, B, v0, r0, dt=1e-4, steps=5000):
    r = np.zeros((steps, 3))
    v = np.zeros((steps, 3))
    r[0], v[0] = r0, v0

    for i in range(1, steps):
        a = lorentz_force(q, m, E, B, v[i-1])
        v[i] = v[i-1] + a * dt
        r[i] = r[i-1] + v[i] * dt

    return r

# Parameters
q = 1.0                  # charge in Coulombs
m = 0.001                # mass in kg (1 g)
E = np.array([100, 50, 0])    # electric field (V/m)
B = np.array([0, 0, 1])       # magnetic field (T)
v0 = np.array([10, 10, 5])    # initial velocity (m/s)
r0 = np.array([0, 0, 0])      # initial position

# Simulate trajectory
trajectory = simulate_particle_motion(q, m, E, B, v0, r0)

# Plot the trajectory in 3D
fig = plt.figure(figsize=(10, 7))
ax = fig.add_subplot(111, projection='3d')
ax.plot(trajectory[:, 0], trajectory[:, 1], trajectory[:, 2], color='purple')
ax.set_title("Complex 3D Trajectory in Combined E and B Fields")
ax.set_xlabel("x (m)")
ax.set_ylabel("y (m)")
ax.set_zlabel("z (m)")
plt.show()
</code></pre>
<hr/>
<p><img alt="alt text" src="../image-7.png"/></p>
<h3 id="what-does-this-show">✨ What Does This Show?</h3>
<p>In this configuration:</p>
<ul>
<li>The <strong>electric field</strong> is not perpendicular to the magnetic field.</li>
<li>The <strong>initial velocity</strong> also has components in multiple directions.</li>
</ul>
<p>This causes the particle to spiral while simultaneously being <strong>accelerated along a drift path</strong>, leading to a <strong>non-circular, non-helical</strong> trajectory that reflects the true complexity of Lorentz-force dynamics in real-world plasmas.</p>
<h3 id="conclusion">✅ Conclusion</h3>
<p>The Lorentz force is a fundamental concept that governs the behavior of charged particles in electromagnetic fields. Through simulations and visualizations, we've seen how particles move in circular, helical, or drifting paths depending on the configuration of electric and magnetic fields. These dynamics are not just theoretical — they underpin real-world technologies such as particle accelerators, fusion devices, and mass spectrometers. By adjusting parameters like field strength and initial velocity, we gain deeper insight into particle control and confinement, which is essential for advancing both scientific research and practical applications in modern physics and engineering.</p>
<hr/>
</div>
</div><footer>
<div aria-label="Footer Navigation" class="rst-footer-buttons" role="navigation">
<a class="btn btn-neutral float-left" href="../../3%20Waves/Problem_1/" title="🌊 Interference Patterns on a Water Surface"><span class="icon icon-circle-arrow-left"></span> Previous</a>
<a class="btn btn-neutral float-right" href="../../5%20Circuits/Problem_1/" title="🎓 Equivalent Resistance Using Graph Theory">Next <span class="icon icon-circle-arrow-right"></span></a>
</div>
<hr/>
<div role="contentinfo">
<!-- Copyright etc -->
</div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
</div>
</div>
</section>
</div>
<div aria-label="Versions" class="rst-versions" role="note">
<span class="rst-current-version" data-toggle="rst-current-version">
<span><a href="../../3%20Waves/Problem_1/" style="color: #fcfcfc">« Previous</a></span>
<span><a href="../../5%20Circuits/Problem_1/" style="color: #fcfcfc">Next »</a></span>
</span>
</div>
<script src="../../../js/jquery-3.6.0.min.js"></script>
<script>var base_url = "../../..";</script>
<script src="../../../js/theme_extra.js"></script>
<script src="../../../js/theme.js"></script>
<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
<script src="../../../search/main.js"></script>
<script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>
</body>
</html>
